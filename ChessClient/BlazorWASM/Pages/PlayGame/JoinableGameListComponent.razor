@using Domain.DTOs
@using Domain.DTOs.GameRoomData
@using HttpClients.ClientInterfaces
@inject IGameService GameService
@inject NavigationManager NavMgr

<MudTable Items="@JoinableGames" Hover="true">
    <HeaderContent>
        <MudTh>Game Id</MudTh>
        <MudTh>Opponent</MudTh>
        <MudTh>Time Control</MudTh>
        <MudTh>Opponent Side</MudTh>
        <MudTh>Join Game</MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="Id">@context.GameRoom</MudTd>
        <MudTd DataLabel="User">@context.Username</MudTd>
        <MudTd DataLabel="Time Control">@(context.Seconds + "+" + context.Increment)</MudTd>
        <MudTd DataLabel="Side">@context.Side</MudTd>
        <MudTd DataLabel="Join">
            <MudButton @onclick="() => JoinGame(context.GameRoom)">Join</MudButton>
        </MudTd>
    </RowTemplate>
    <PagerContent>
        <MudTablePager/>
    </PagerContent>
</MudTable>

@code {
    [Parameter]
    public IList<JoinableGameRoomDataDto>? JoinableGames { get; set; }

    private async void JoinGame(ulong i)
    {
        await GameService.JoinGame(new RequestJoinGameDto
        {
            GameRoom = i
        });
        NavMgr.NavigateTo("/ChessGame");
    }
}