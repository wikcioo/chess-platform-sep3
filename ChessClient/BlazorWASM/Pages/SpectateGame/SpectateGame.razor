@page "/SpectateGame"
@using Domain.DTOs.GameRoomData
@using HttpClients.ClientInterfaces
@inject IGameService GameService
@inject ISnackbar Snackbar

<MudContainer Class="mt-10">
    <MudContainer Class="d-flex justify-end">
        <MudIconButton Icon="@Icons.Filled.Refresh"
                       @onclick="@(async () => { Snackbar.Add("Refreshed", Severity.Success); await RefreshSpectateableGames(); })"/>
    </MudContainer>
    <SpectateableGameListComponent SpectateableGames="@_spectateableGames"/>
</MudContainer>

@code {
    private IList<SpectateableGameRoomDataDto>? _spectateableGames;

    protected override async Task OnInitializedAsync()
    {
        await RefreshSpectateableGames();
    }

    private async Task RefreshSpectateableGames()
    {
        _spectateableGames = await GameService.GetAllSpectateableGames();
        Snackbar.Add("Refreshed", Severity.Success);
    }
}